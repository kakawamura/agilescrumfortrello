var AST=AST||{};!function(r){"use strict";$(r).ready(function(){AST=function(r){var n="Agile SCRUM for Trello boards",t="1.4.3",a=/\([0-9\.]{1,6}\/[0-9\.]{1,6}\)/,s=/\([0-9\.]{1,6}\//,e=/\/[0-9\.]{1,6}\)/,c=/\([0-9\.]{1,5}\)/,i=/[0-9\.]+/,o=/\[([\u3400-\uFAFF\u3040-\u30ff\uff65-\uffdca-zA-ZáãàâäéèẽêëíìĩîïóòõôöúùũûüçÁÃÀÂÄÉÈẼÊËÍÌĨÎÏÓÒÕÔÖÚÙŨÛÜÇ0-9 \_\-\.\#]*)\]/g,l=/>\*{3} .+ \*{3}$/i,d=/c\/([^/]+)\/.+/g,u=1,m=!1,h=0,p="",f=!1,g=5e3,b=0,v=!1,T=0,w=0,M=!1,A=0,L=0,y=!1,C=0,H=0,S=!1,k=!1;r.init=function(){console.info(n+" v"+t+" started"),x(),U()};var x=function(){var r=null,n=null;U(),$(".window-wrapper").bind("DOMSubtreeModified",function(){window.location.href.match(d)&&!n?(r=d.exec(window.location.href)[1],d.lastIndex=0,n=!0):!window.location.href.match(d)&&n&&(n=!1,U())}),f=setInterval(function(){F()},g)},F=function(){var r=$("#board").html().length;b!==r&&(b=r,U())},U=function(){m=$("body").css("background-color")&&!$("body").hasClass("body-custom-board-background")?$("body").css("background-color"):"rgb(55, 158, 90)",j(),$("#board").find(".list-cards").each(function(){v=$(this),v.find(".list-card").each(function(){return y=$(this),z(y)?-2:($(y).find(".list-card-title").html().match(/<small /g)?(S=y.data("original"),$(y).find(".list-card-title").html(S)):(S=$(y).find(".list-card-title").html(),y.data("original",S)),I(S)?(L>0&&D(),M=y,M[0].innerHTML=M[0].innerHTML.replace(/( ?\*\*\* ?)/g,""),M.addClass("scrum-card-header")):S.match(a)?(k=S.match(a)[0],C=O(k.match(s)[0]),H=O(k.match(e)[0])):S.match(c)&&(H=O(S.match(c)[0])),p=C==H?" perfect":C>H?" overrun":"",y[0].innerHTML=y[0].innerHTML.replace(c,Z),y[0].innerHTML=y[0].innerHTML.replace(a,Z),y[0].innerHTML=y[0].innerHTML.replace(o,R),H>0&&(h=C/H*100,y.prepend('<div class="scrum-card-progress'+p+'" style="background-color:'+m+";width:"+(100>=h?h:100)+'%"></div>'),$(y[0]).css("font-size",(8>H?90+5*H:130)+"%").css("line-height","1.2em")),T+=C,w+=H,M&&(A+=C,L+=H),y=!1,S=k="",void(H=C=0))}),L>0&&D(),v.parent().prepend('<small class="scrum-list-total'+p+'"><span class="scrum-light">'+T.toFixed(u)+"/</span>"+w.toFixed(u)+"</small>"),w>0&&(h=T/w*100,v.parent(".list").prepend('<div class="scrum-list-progress"  style="background-color:'+m+";width:"+(100>=h?h:100)+'%"></div>')),v=!1,T=w=0})},j=function(){$(".scrum-list-total,.scrum-list-progress,.scrum-card-progress").remove()},z=function(){return y.hasClass("js-composer")},I=function(r){return r.match(l)},D=function(){$(M.find(".list-card-title")[0]).prepend('<small class="scrum-card-points'+(A>L?" overrun":"")+'"><span class="scrum-light">'+A.toFixed(u)+"/</span>"+L.toFixed(u)+"</small>"),A=L=0},O=function(r){return parseFloat(r.match(i)[0])},R=function(r){return'<small class="scrum-card-project" style="background:'+_(r)+'">'+r.replace(/\[|\]/g,"").toUpperCase()+"</small>"},Z=function(r){return'<small class="scrum-card-points'+p+'">'+r.replace(/\(|\)/g,"").toUpperCase()+"</small>"},_=function(r){var n=0,t=0,a=r.length;for(r=r.toLowerCase();a>t;t++)n+=900*r.charAt(t).charCodeAt();return"hsla("+n%256+",50%,40%,1)"};return r}(AST||{}),AST.init()})}(document);
